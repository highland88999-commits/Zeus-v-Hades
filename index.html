<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>HADES vs ZEUS â€¢ NEON SOUL RACE</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=VT323&display=swap" rel="stylesheet" />
  <style>
    :root {
      --neon-cyan: #00f0ff;
      --neon-magenta: #ff0066;
      --neon-gold: #ffe700;
      --neon-green: #39ff14;
      --neon-purple: #c300ff;
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      margin:0;
      overflow:hidden;
      background:#000;
      font-family:'Orbitron',sans-serif;
      color:var(--neon-cyan);
      height:100dvh;
      touch-action:none;
    }

    #stars {
      position:fixed;
      inset:0;
      background:radial-gradient(ellipse at bottom, #0b001f 0%,#000 100%);
      z-index:-2;
      pointer-events:none;
    }
    .star {
      position:absolute;
      background:white;
      border-radius:50%;
      box-shadow:0 0 8px rgba(255,255,255,0.8);
      animation:twinkle 5s infinite alternate;
    }
    @keyframes twinkle { 0%,100%{opacity:0.35} 50%{opacity:0.95} }

    #gameContainer {
      position:relative;
      width:100dvw;
      height:100dvh;
      overflow:hidden;
    }
    #gameCanvas {
      display:block;
      width:100%;
      height:100%;
      image-rendering:crisp-edges;
      touch-action:none;
    }

    /* Overlays */
    #landingOverlay,
    #startVideoOverlay,
    #gameOverOverlay {
      position:fixed;
      inset:0;
      z-index:100;
      background:rgba(0,0,0,0.92);
      backdrop-filter:blur(10px);
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      color:var(--neon-cyan);
      font-size:clamp(1.4rem,5vw,2.8rem);
      text-align:center;
      cursor:pointer;
    }
    .hidden { display:none !important; }

    #countdown {
      font-size:clamp(8rem,25vw,16rem);
      font-weight:900;
      text-shadow:0 0 50px var(--neon-gold),0 0 100px var(--neon-cyan);
      margin-bottom:1.5rem;
      animation:pulse 1s infinite alternate;
    }
    @keyframes pulse { to { transform:scale(1.08); } }

    .neon-title {
      font-size:clamp(4rem,14vw,9rem);
      font-weight:900;
      letter-spacing:0.1em;
      background:linear-gradient(90deg,var(--neon-magenta),var(--neon-cyan),var(--neon-magenta));
      -webkit-background-clip:text;
      background-clip:text;
      -webkit-text-fill-color:transparent;
      text-shadow:0 0 40px var(--neon-magenta);
      animation:glitch 4s infinite;
    }
    @keyframes glitch {
      0%,100%{text-shadow:5px 0 var(--neon-magenta),-5px 0 var(--neon-cyan)}
      20%{text-shadow:-5px 0 var(--neon-magenta),5px 0 var(--neon-cyan)}
      40%{text-shadow:5px 0 var(--neon-cyan),-5px 0 var(--neon-magenta)}
      60%{text-shadow:-7px 0 var(--neon-magenta),7px 0 var(--neon-cyan)}
      80%{text-shadow:7px 0 var(--neon-cyan),-7px 0 var(--neon-magenta)}
    }

    #hud {
      position:fixed;
      top:0; left:0; right:0;
      padding:clamp(0.8rem,2vw,1.2rem) 2rem;
      display:flex;
      justify-content:space-between;
      background:rgba(0,0,0,0.7);
      backdrop-filter:blur(14px);
      z-index:30;
      font-size:clamp(1.2rem,3.5vw,1.9rem);
      pointer-events:none;
    }
    .score-box {
      background:rgba(10,10,30,0.75);
      padding:0.6rem 1.4rem;
      border-radius:1rem;
      border:2px solid;
      box-shadow:0 0 25px;
    }
    #playerScore { border-color:var(--neon-cyan); color:var(--neon-cyan); left:0; position:absolute; }
    #oppScore   { border-color:var(--neon-magenta); color:var(--neon-magenta); right:0; position:absolute; }
    #timer      { color:var(--neon-gold); font-weight:900; margin:auto; }

    /* Scanlines */
    body::before {
      content:'';
      position:fixed;
      inset:0;
      background:repeating-linear-gradient(to bottom,transparent 0,transparent 2px,rgba(0,0,0,0.32) 2px,rgba(0,0,0,0.32) 4px);
      pointer-events:none;
      z-index:999;
      opacity:0.55;
    }
  </style>
</head>
<body>

<div id="stars"></div>

<div id="gameContainer">
  <canvas id="gameCanvas"></canvas>

  <!-- Landing Video -->
  <div id="landingOverlay">
    <video id="landingVideo" playsinline>
      <source src="https://www.dropbox.com/scl/fi/9mz9tl38fbz6f0e1tj30y/Make_it_epic._H-3.mp4?rlkey=4rk9zotckomw7ugprgdp8lro1&st=ejqlz1hl&raw=1" type="video/mp4" />
    </video>
    <div class="neon-title">CLICK TO ENTER THE VOID</div>
  </div>

  <!-- Start Video + 3s Countdown -->
  <div id="startVideoOverlay" class="hidden">
    <video id="startVideo" playsinline>
      <source src="https://www.dropbox.com/scl/fi/4r1tkm2o12essg59t5iyk/Make_it_epic._H-2.mp4?rlkey=rcv76t3n3vyouwkp96a16mkyi&st=07jeqjbn&raw=1" type="video/mp4" />
    </video>
    <div id="countdown">3</div>
  </div>

  <!-- HUD -->
  <div id="hud" class="hidden">
    <div id="playerScore" class="score-box">YOU: <span id="pScore">0</span></div>
    <div id="timer">2:00</div>
    <div id="oppScore" class="score-box">OPP: <span id="oScore">0</span></div>
  </div>

  <!-- Game Over -->
  <div id="gameOverOverlay" class="hidden">
    <div class="neon-title">RACE TERMINATED</div>
    <p id="goResult" style="font-size:clamp(2.2rem,7vw,4.5rem); margin:2.5rem 0;"></p>
    <p id="goScore" style="font-size:clamp(1.8rem,5.5vw,3.2rem); color:var(--neon-gold);"></p>
    <button onclick="location.reload()" style="margin-top:4rem; padding:1.2rem 3rem; font-size:clamp(1.4rem,4.5vw,2.2rem);" class="neon-btn">RE-ENTER NEON REALM</button>
  </div>
</div>

<audio id="bgm" loop></audio>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CONFIG
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const WORLD_W = 5200;
const WORLD_H = 3900;
const GAME_TIME = 120;
const POSEIDON_INTERVAL = 30;
const BASE_SOULS = 90;

const DIFFICULTY = {
  easy:   { aiSpeed:4.3, redChance:0.14, powerChance:0.07, speedChance:0.10 },
  medium: { aiSpeed:5.7, redChance:0.26, powerChance:0.05, speedChance:0.08 },
  hard:   { aiSpeed:7.2, redChance:0.38, powerChance:0.04, speedChance:0.06 }
};

let difficulty = 'medium'; // default
let playerChar = 'Zeus'; // default

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // STATE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let canvas, ctx;
let player, opponent, souls = [], particles = [], stars = [];
let camX = 0, camY = 0, zoom = 1, targetZoom = 1;
let timeLeft = GAME_TIME;
let poseidonTimer = POSEIDON_INTERVAL;
let isRunning = false;
let floodProgress = 0;
let isFlooding = false;
let isDragging = false;

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // DOM
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const landingOverlay = document.getElementById('landingOverlay');
const landingVideo = document.getElementById('landingVideo');
const startOverlay = document.getElementById('startVideoOverlay');
const startVideo = document.getElementById('startVideo');
const countdownEl = document.getElementById('countdown');
const hud = document.getElementById('hud');
const pScoreEl = document.getElementById('pScore');
const oScoreEl = document.getElementById('oScore');
const timerEl = document.getElementById('timer');
const gameOverOverlay = document.getElementById('gameOverOverlay');
const goResult = document.getElementById('goResult');
const goScore = document.getElementById('goScore');
const bgm = document.getElementById('bgm');

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // MUSIC
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const musicTracks = [
  "https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&mute=0&controls=0&loop=1",
  "https://www.youtube.com/embed/jfKfPfyJRdk?autoplay=1&mute=0&controls=0&loop=1",
  "https://www.youtube.com/embed/9bZkp7q19f0?autoplay=1&mute=0&controls=0&loop=1",
];

function playRandomMusic() {
  const track = musicTracks[Math.floor(Math.random() * musicTracks.length)];
  bgm.src = track;
  bgm.volume = 0.5;
  bgm.muted = false;
  bgm.play().catch(e => console.log("Autoplay blocked:", e));
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // INIT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function init() {
  canvas = document.getElementById('gameCanvas');
  ctx = canvas.getContext('2d');
  resize();
  window.addEventListener('resize', resize);
  createStars();

  // Sequential videos
  landingOverlay.addEventListener('click', () => {
    if (landingVideo.paused) {
      landingVideo.play().catch(() => {});
    } else {
      landingOverlay.classList.add('hidden');
      landingVideo.pause(); // stop landing audio
      startOverlay.classList.remove('hidden');
      startVideo.play().catch(() => {});
      startCountdown();
    }
  });

  setupControls();
}

function createStars() {
  for (let i = 0; i < 700; i++) {
    stars.push({
      x: Math.random() * WORLD_W,
      y: Math.random() * WORLD_H,
      size: Math.random() * 2.2 + 0.5,
      phase: Math.random() * Math.PI * 2
    });
  }
}

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  targetZoom = Math.min(canvas.width / WORLD_W, canvas.height / WORLD_H); // default full view
}

function startCountdown() {
  let cd = 3;
  countdownEl.textContent = cd;
  const interval = setInterval(() => {
    cd--;
    countdownEl.textContent = cd;
    if (cd <= 0) {
      clearInterval(interval);
      startOverlay.classList.add('hidden');
      startVideo.pause(); // stop start video audio
      hud.classList.remove('hidden');
      resetGame();
      isRunning = true;
      requestAnimationFrame(gameLoop);
      setInterval(gameTimer, 1000);
      playRandomMusic();
    }
  }, 1000);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // RESET
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function resetGame() {
  timeLeft = GAME_TIME;
  poseidonTimer = POSEIDON_INTERVAL;
  floodProgress = 0;
  isFlooding = false;

  player = {
    x: WORLD_W / 2,
    y: WORLD_H / 2,
    baseSpeed: 6,
    speedMult: 1,
    speedEnd: 0,
    size: 34,
    color: playerChar === 'Zeus' ? '#00f0ff' : '#ff0066',
    symbol: playerChar === 'Zeus' ? 'âš¡' : 'ðŸ’€',
    score: 0
  };

  opponent = {
    x: WORLD_W / 2 + (Math.random() - 0.5) * 1400,
    y: WORLD_H / 2 + (Math.random() - 0.5) * 1400,
    speed: DIFFICULTY[difficulty].aiSpeed,
    size: 34,
    color: playerChar === 'Zeus' ? '#ff0066' : '#00f0ff',
    symbol: playerChar === 'Zeus' ? 'ðŸ’€' : 'âš¡',
    score: 0,
    target: null
  };

  souls = [];
  particles = [];
  generateSouls(BASE_SOULS);
  updateHUD();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // SOUL GENERATOR
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function generateSouls(count) {
  const cfg = DIFFICULTY[difficulty];
  for (let i = 0; i < count; i++) {
    const r = Math.random();
    let type = 'blue', val = 100, col = '#88ddff', rad = 12;
    if (r < cfg.redChance) { type = 'red'; val = -25; col = '#ff4444'; rad = 13; }
    else if (r < cfg.redChance + cfg.powerChance) { type = 'power'; val = 250; col = '#ffd700'; rad = 18; }
    else if (r < cfg.redChance + cfg.powerChance + cfg.speedChance) { type = 'speed'; val = 0; col = '#00aaff'; rad = 15; }

    souls.push({
      x: Math.random() * WORLD_W,
      y: Math.random() * WORLD_H,
      radius: rad,
      color: col,
      value: val,
      type,
      pulse: Math.random() * Math.PI * 2
    });
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // TIMER
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function gameTimer() {
  if (!isRunning) return;
  timeLeft--;
  poseidonTimer--;
  if (poseidonTimer <= 0) {
    isFlooding = true;
    floodProgress = 0;
    poseidonTimer = POSEIDON_INTERVAL;
  }
  if (timeLeft <= 0) endGame();
  updateHUD();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// LOOP
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function gameLoop() {
  if (!isRunning) return;

  updateGame();
  drawGame();

  requestAnimationFrame(gameLoop);
}

function updateGame() {
  if (player.speedEnd > Date.now() / 1000) {
    player.speedMult = 2;
  } else {
    player.speedMult = 1;
  }

  updateOpponent();
  checkCollisions();
  updateParticles();
  updateCamera();

  if (isFlooding) {
    floodProgress += 0.02;
    if (floodProgress >= 1) {
      souls = [];
      isFlooding = false;
      generateSouls(BASE_SOULS + 25);
    }
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // CONTROLS (mouse/touch drag)
 // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setupControls() {
  canvas.addEventListener('pointerdown', e => {
    e.preventDefault();
    isDragging = true;
  });

  canvas.addEventListener('pointermove', e => {
    if (!isRunning || !isDragging) return;
    e.preventDefault();

    const rect = canvas.getBoundingClientRect();
    player.x = (e.clientX - rect.left) * (WORLD_W / rect.width) + camX;
    player.y = (e.clientY - rect.top) * (WORLD_H / rect.height) + camY;

    player.x = Math.max(20, Math.min(WORLD_W - 20, player.x));
    player.y = Math.max(20, Math.min(WORLD_H - 20, player.y));
  });

  canvas.addEventListener('pointerup', () => {
    isDragging = false;
  });

  // Zoom
  canvas.addEventListener('wheel', e => {
    e.preventDefault();
    const delta = e.deltaY < 0 ? 0.1 : -0.1;
    targetZoom = Math.max(0.6, Math.min(2.5, targetZoom + delta));
  }, { passive: false });

  let initialDist = 0;
  canvas.addEventListener('touchstart', e => {
    if (e.touches.length === 2) {
      initialDist = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY);
    }
  }, { passive: false });

  canvas.addEventListener('touchmove', e => {
    if (e.touches.length === 2) {
      e.preventDefault();
      const dist = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY);
      const delta = (dist - initialDist) / 400;
      targetZoom = Math.max(0.6, Math.min(2.5, targetZoom + delta));
      initialDist = dist;
    }
  }, { passive: false });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// HUD & END GAME
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateHUD() {
  pScoreEl.textContent = player.score;
  oScoreEl.textContent = opponent.score;

  const min = Math.floor(timeLeft / 60);
  const sec = (timeLeft % 60).toString().padStart(2, '0');
  timerEl.textContent = `${min}:${sec}`;
}

function endGame() {
  isRunning = false;

  const result = player.score > opponent.score ? 'VICTORY' :
                 player.score < opponent.score ? 'DEFEAT' : 'STALEMATE';

  goResult.innerHTML = `<span style="color:${result==='VICTORY' ? 'var(--neon-green)' : 'var(--neon-magenta)'}">${result}</span>`;
  goScore.textContent = `YOU ${player.score} â€¢ OPP ${opponent.score}`;

  gameOverOverlay.classList.remove('hidden');
  hud.classList.add('hidden');
}

init();
</script>
</body>
</html>
